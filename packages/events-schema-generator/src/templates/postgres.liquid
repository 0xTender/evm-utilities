model Contract {
    id      Int    @id @default(autoincrement())
    
    name String

    address String
    chainId Int
    transactionHash String

    deploymentBlock  Int
    indexedTillBlock Int

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    Event     Event[]

}   


model Event {
    id                Int      @id @default(autoincrement())
    Contract          Contract @relation(fields: [ContractId], references: [id])
    ContractId        Int

    block             Int
    transactionHash   String
    logIndex          Int
    createdAt         DateTime @default(now())
    updatedAt         DateTime @updatedAt

    {% for event in events %}
    E_{{-event.name}}_{{event.contract_name}} E_{{event.name}}_{{event.contract_name-}}[]
    {% endfor %}

}

{% for event in events %}
model E_{{-event.name}}_{{event.contract_name}} {
    id      Int    @id @default(autoincrement())
    Event   Event? @relation(fields: [eventId], references: [id])
    eventId Int?   @unique

    {% for arg in event.inputs %}
    A_{{arg.name}} String
    {% endfor %}
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

}
{% endfor %} 
{% comment %} }

model {{event.name}}_{{contract_name}}_Event {
    id      Int    @id @default(autoincrement())
    {{event.name}}_{{contract_name}} {{event.name}}_{{contract_name}} @relation(fields: [{{event.name}}_{{contract_name}}_Id], references: [id])
    {{event.name}}_{{contract_name}}_Id Int @unique

    @@schema("event")
}

 {% endcomment %}
